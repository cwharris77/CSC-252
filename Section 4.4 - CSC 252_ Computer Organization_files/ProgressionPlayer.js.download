define("ProgressionPlayer",["exports"],function(exports){function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function Controllers(){}function buildElementCheckboxControllerPrototype(){ElementCheckboxController.prototype=new ProgressionPlayerElementController,ElementCheckboxController.prototype.constructor=ElementCheckboxController,ElementCheckboxController.prototype.isAssessedForCorrectness=!0,ElementCheckboxController.prototype.doesSupportFocus=!0,ElementCheckboxController.prototype.focus=function(){this._$input.focus()},ElementCheckboxController.prototype.render=function(){ProgressionPlayerElementController.prototype.render.apply(this);var a=parseInt(this._$element.find("label").first().css("font-size"),10),b=10,c=b;a>b&&(c=b+Math.floor((a-b)/2)),this._$input=this._$element.find("input"),this._$input.first().width(c).height(c)},ElementCheckboxController.prototype.isCorrect=function(){return this._elementRendered.correctAnswerIsChecked===this._$input.is(":checked")},ElementCheckboxController.prototype.markAsWrongAnswer=function(){this._$element.addClass("wrong-answer")},ElementCheckboxController.prototype._elementSpecificUserAnswer=function(){return this._$input.is(":checked")?"checked":"unchecked"},ElementCheckboxController.prototype._elementSpecificExpectedAnswer=function(){return this._elementRendered.correctAnswerIsChecked?"checked":"unchecked"},ElementCheckboxController.prototype.disable=function(){this._$input.prop("disabled",!0)},ElementCheckboxController.prototype.enable=function(){this._$input.prop("disabled",!1)},ElementCheckboxController.prototype.setAnswer=function(a){this._$input.prop("checked","checked"===a)}}function buildElementDropdownControllerPrototype(){ElementDropdownController.prototype=new ProgressionPlayerElementController,ElementDropdownController.prototype.constructor=ElementDropdownController,ElementDropdownController.prototype.render=function(){var a=this;ProgressionPlayerElementController.prototype.render.apply(this),this._$element.find("select").change(function(){a._elementRendered.options.forEach(function(a){a.isSelected=!1});var b=a._$element.find("option:selected").index();a._elementRendered.options[b].isSelected=!0})},ElementDropdownController.prototype.isAssessedForCorrectness=!0,ElementDropdownController.prototype.doesSupportFocus=!0,ElementDropdownController.prototype.focus=function(){this._$element.find("select").focus()},ElementDropdownController.prototype.isCorrect=function(){return this._elementRendered.options.some(function(a){return a.isSelected&&a.isCorrectOption})},ElementDropdownController.prototype._getSelectedOption=function(){return this._elementRendered.options.filter(function(a){return a.isSelected})[0]},ElementDropdownController.prototype.isInvalidAnswer=function(){return this._getSelectedOption().isInvalidOption},ElementDropdownController.prototype._elementSpecificUserAnswer=function(){return this._getSelectedOption().text},ElementDropdownController.prototype._elementSpecificExpectedAnswer=function(){return this._elementRendered.options.find(function(a){return a.isCorrectOption}).text},ElementDropdownController.prototype.disable=function(){this._$element.find("select").prop("disabled",!0)},ElementDropdownController.prototype.enable=function(){this._$element.find("select").prop("disabled",!1)},ElementDropdownController.prototype.setAnswer=function(a){this._$element.find("select").val(a).change()}}function ElementImageController(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];0!==b.length&&(ProgressionPlayerElementController.prototype.constructor.apply(this,b),this.render())}function buildElementImageControllerPrototype(){ElementImageController.prototype=new ProgressionPlayerElementController,ElementImageController.prototype.constructor=ElementImageController,ElementImageController.prototype.render=function(){var a=this;ProgressionPlayerElementController.prototype.render.apply(this);var b=this._$element.find("img");b.on("load",function(){return b.attr("alt",a._elementRendered.alt)}),require("ProgressionUtilities").create().downloadImage(this._parentResource,this._elementRendered.imageID,b,"Image did not load. Please try refreshing. If the issue persists, please contact support@zybooks.com.")}}function ElementShortAnswerController(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];0!==b.length&&(ProgressionPlayerElementController.prototype.constructor.apply(this,b),this._utilities=require("utilities"),this.render())}function buildElementShortAnswerControllerPrototype(){ElementShortAnswerController.prototype=new ProgressionPlayerElementController,ElementShortAnswerController.prototype.constructor=ElementShortAnswerController,ElementShortAnswerController.prototype.render=function(){var a=this;ProgressionPlayerElementController.prototype.render.apply(this),this._$element.keypress(function(b){b.which===a._utilities.ENTER_KEY&&a._progressionTool.check()})},ElementShortAnswerController.prototype.isAssessedForCorrectness=!0,ElementShortAnswerController.prototype.doesSupportFocus=!0,ElementShortAnswerController.prototype.focus=function(){this._$element.find("input").focus()},ElementShortAnswerController.prototype.isCorrect=function(){var a=!1;switch(this._elementRendered.assessmentMethod){case"stringMatch":a=this._isCorrectStringMatch();break;case"numericalMatch":a=this._isCorrectNumericalMatch();break;default:require("zyWebErrorManager").postError("Short answer element has unknown assessment method.")}return a},ElementShortAnswerController.prototype._isCorrectStringMatch=function(){var a=this,b=this._elementRendered.assessmentProperties.caseSensitive,c=this._processStringAnswer(this._elementSpecificUserAnswer(),b).replace(/[“|”]/g,'"').replace(/[‘|’]/g,"'");return this._elementRendered.correctAnswers.map(function(c){return a._processStringAnswer(c,b)}).some(function(a){return c===a})},ElementShortAnswerController.prototype._processStringAnswer=function(a,b){var c=this._utilities.removeWhitespace(a);return b?c:c.toLowerCase()},ElementShortAnswerController.prototype._isCorrectNumericalMatch=function(){var a=parseFloat(this._utilities.removeWhitespace(this._elementSpecificUserAnswer())),b=this._elementRendered.assessmentProperties.tolerancePercentage,c=b||0===b,d=b/100,e=this._elementRendered.assessmentProperties.toleranceAbsoluteValue;return this._elementRendered.correctAnswers.some(function(b){var f=parseFloat(b);return Math.abs(f-a)<=(c?Math.abs(f*d):e)})},ElementShortAnswerController.prototype._elementSpecificUserAnswer=function(){return this._$element.find("input").val()},ElementShortAnswerController.prototype._elementSpecificExpectedAnswer=function(){return this._elementRendered.correctAnswers},ElementShortAnswerController.prototype.isInvalidAnswer=function(){return""===this._elementSpecificUserAnswer()},ElementShortAnswerController.prototype.disable=function(){this._$element.find("input").prop("disabled",!0)},ElementShortAnswerController.prototype.enable=function(){this._$element.find("input").prop("disabled",!1)},ProgressionPlayerElementController.prototype.setAnswer=function(a){this._$element.find("input").val(a)}}function buildElementTableControllerPrototype(){ElementTableController.prototype=new ProgressionPlayerElementController,ElementTableController.prototype.constructor=ElementTableController,ElementTableController.prototype.render=function(){var a=this;if(ProgressionPlayerElementController.prototype.render.apply(this),this._elementRendered.isSpreadsheet){var b=this._$element.find("button");if(ClipboardJS.isSupported()){var c=this._elementRendered.tableData.map(function(a){return a.map(function(a){return a.content})});require("ProgressionUtilities").create().removeSpreadsheetHeaders(c);var d=c.map(function(a){return a.join("\t")}).join("\n");b.attr({"data-clipboard-text":d,title:"Copied!"}).tooltip({close:function(){b.tooltip("disable")},disabled:!0}),this.clipboard=new ClipboardJS(b.get(0)),this.clipboard.on("success",function(){b.tooltip("enable").tooltip("open"),a._parentResource.postEvent({part:a._progressionTool.currentQuestionNumber,complete:!1,metadata:{message:"Copy sheet clicked"}})})}else b.remove()}},ElementTableController.prototype.destroy=function(){ProgressionPlayerElementController.prototype.destroy.apply(this),this.clipboard&&this.clipboard.destroy()},ElementTableController.prototype._makeElementToRender=function(){var a=this._elementRendered.clone();return require("ProgressionUtilities").create().makeTableElementToRender(a)}}function ElementTextController(){ProgressionPlayerElementController.prototype.constructor.apply(this,arguments),this.render()}function buildElementTextControllerPrototype(){ElementTextController.prototype=new ProgressionPlayerElementController,ElementTextController.prototype.constructor=ElementTextController}function ProgressionPlayer(){this._name="ProgressionPlayer",this._templates=this[this._name],this._id=null,this._inBuilderMode=!1,this._controllers=new Controllers,this._$question=null,this._currentQuestion=null,this._parentResource=null,this._questionCache=null,this._progressionTool=null,this._isExam=!1,this._isExamResponse=!1,this.init=function(a,b,c){var d=this;this._id=a,this._parentResource=b,this._isExamResponse=c.showExamResponse||!1;var e=1;if(this._isExamResponse)this._isExam=!0,this._currentQuestion=this._makeQuestionFromJSON(c.question.levelIndex,c.question);else{this._inBuilderMode=c.inBuilderMode||!1;var f=this._inBuilderMode?c.progression:unescapeHTMLFromJSON(c.progression);this._isExam=!this._inBuilderMode&&f.isExam;var g=new ProgressionQuestionFactory(f,this._inBuilderMode);this._questionCache=require("utilities").getQuestionCache(g,5),e=g.numberOfLevels()}var h=require("ProgressionUtilities").create();this._templates=h.templates;var i=this,j=!1;this._progressionTool=require("progressionTool").create(),this._progressionTool.init(a,b,{html:this._templates.QuestionArea(),css:'<style>.zyante-bold{font-family:HelveticaNeue-Light,"Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;font-weight:300}.zyante-section-bold{font-family:Helvetica;font-weight:300}.ProgressionPlayer div.question-area .wrong-answer-outline,.ProgressionPlayer div.question-area .invalid-answer-outline{outline:2px solid #bb0404}.ProgressionPlayer div.question-area .element{font-family:Roboto,sans-serif;font-weight:300}.ProgressionPlayer div.question-area .element.wrong-answer select,.ProgressionPlayer div.question-area .element.wrong-answer input:not([type=checkbox]){outline:2px solid #bb0404}.ProgressionPlayer div.question-area .element.wrong-answer.checkbox-element{outline:2px solid #bb0404}.ProgressionPlayer div.question-area .element.invalid-answer select,.ProgressionPlayer div.question-area .element.invalid-answer input{outline:2px solid #bb0404}.ProgressionPlayer .zyante-progression-explanation-area p{font-family:Roboto,sans-serif;font-weight:300;margin:0 0 10px}.ProgressionPlayer .white-space-pre{white-space:pre-wrap}.ProgressionPlayer div.zyante-progression-explanation-area .element{white-space:normal}</style>'+h.css,numToWin:e,useMultipleParts:!0,isExam:this._isExam,start:function(){d._controllers.enable(),d._isExam||d._controllers.focus(),j=!1},reset:function(){i._generateQuestion(0),i._controllers.disable()},next:function(a){return j&&d._currentQuestion.levelIndex===a?(d._controllers.removeInvalidAnswerStatus(),d._controllers.enable()):d._generateQuestion(a),d._controllers.focus(),j=!1,d.showExplanationInBuilder(),d._inBuilderMode},isCorrect:function(a){d._controllers.disable();var c="",e=!1,f=JSON.stringify(d._controllers.userAnswer());if(j=d._controllers.isInvalidAnswer()){var g="Set an answer for each input. See highlighted.";d._inBuilderMode&&(g+="\n"+d._currentQuestion.explanation),c=h.processExplanation(b,g)}else if(e=d._controllers.isCorrect(!d._isExam),d._isExam)c="<big>Submission received.</big>\nIf you like, submit a different answer via Try again. Score will be based only on the latest submission.";else{var i=d._controllers.getControllersAssessedForCorrectness().length,k="";!e&&i>1&&(k="Each incorrect answer is highlighted.\n"),k+=d._currentQuestion.explanation,c=h.processExplanation(b,k)}var l={question:d._currentQuestion.toJSON()};return d._isExam&&(b.setLocalStore("user-answer-"+d._id+"-"+a,f),l.isCorrect=e),{expectedAnswer:d._controllers.expectedAnswer(),isCorrect:e&&!d._isExam,explanationAsText:!0,explanationMessage:c,metadata:l,userAnswer:f,showTryAgain:j,callbackFunction:h.postProcessExplanation,callbackParameters:{id:d._id,parentResource:b}}},initialize:function(){var b=$("#"+a);b.find(".zyante-progression-explanation").addClass("white-space-pre"),d._$question=b.find(".question-area"),d._generateQuestion(0),d._controllers.disable(),d._inBuilderMode&&$(".zyante-progression-start-button").trigger("click");var e=!1;if(d._isExamResponse)d._controllers.setAnswers(c.response),e=!0;else if(d._isExam){var f=0,g=d._parentResource.getLocalStore("user-answer-"+d._id+"-"+f);g&&(d._controllers.setAnswers(JSON.parse(g)),e=!0)}return e}})},this.showExplanationInBuilder=function(){if(this._inBuilderMode){var a=require("ProgressionUtilities").create(),b=a.processExplanation(this._parentResource,this._currentQuestion.explanation,!0);this._progressionTool.outputThenScrollToExplanation(b,!1,!0)}},this.jumpToLevelIndex=function(a){this._progressionTool.jumpToLevelIndex(a)},this.focus=function(){this._controllers.focus()},this._makeQuestionFromJSON=function(a,b){var c=new ProgressionQuestionElements;return c.fromJSON(b.elements),new ProgressionQuestion(c,b.explanation,b.height,b.width,a)},this._generateQuestion=function(currentLevel){var _this9=this,enableControllers=this._currentQuestion&&this._isExam&&!this._isExamResponse,needQuestion=!this._currentQuestion||!this._isExam,noQuestionRendered=!this._controllers.length,renderQuestion=needQuestion||this._isExamResponse&&noQuestionRendered;if(enableControllers?this._controllers.enable():needQuestion&&(this._controllers.empty(),this._currentQuestion=require("utilities").makeQuestionFromCacheOrLocalStore({id:this._id,isExam:this._isExam,levelIndex:currentLevel,parentResource:this._parentResource,questionCache:this._questionCache,makeQuestionFromJSON:function(a){return _this9._makeQuestionFromJSON(currentLevel,a)}}),this._parentResource.setA11yReview&&this._parentResource.setA11yReview(makeA11yPreview(this._currentQuestion))),renderQuestion){this._$question.height(this._currentQuestion.height).width(this._currentQuestion.width),$("#"+this._id).width(this._currentQuestion.width);var $explanation=$("#"+this._id+" .zyante-progression-explanation-area");$explanation.width(this._currentQuestion.width);var progressionUtilities=require("ProgressionUtilities").create();if(this._currentQuestion.elements.slice().reverse().forEach(function(element){var elementClassName=progressionUtilities.getElementClassNameByType(element.type),controllerClassName=elementClassName+"Controller",ControllerClass=eval(controllerClassName);_this9._controllers.push(new ControllerClass(element,_this9._$question,_this9._templates,_this9._parentResource,_this9._progressionTool))}),needQuestion&&this._parentResource.setSolution){var explanation=progressionUtilities.processExplanation(this._parentResource,this._currentQuestion.explanation,!0),shouldRenderAsHTML=!0;this._parentResource.setSolution(explanation,"text",shouldRenderAsHTML)}this.showExplanationInBuilder(),this._parentResource.latexChanged()}}}function buildDelayedPrototypes(){this.hasBeenBuilt||(buildProgressionPlayerElementControllerPrototype(),buildElementImageControllerPrototype(),buildElementTextControllerPrototype(),buildElementDropdownControllerPrototype(),buildElementShortAnswerControllerPrototype(),buildElementTableControllerPrototype(),buildElementCheckboxControllerPrototype(),this.hasBeenBuilt=!0)}function ProgressionPlayerElementController(){require("ProgressionUtilities").create().inheritElementController().constructor.apply(this,arguments)}function buildProgressionPlayerElementControllerPrototype(){ProgressionPlayerElementController.prototype=require("ProgressionUtilities").create().inheritElementController(),ProgressionPlayerElementController.prototype.constructor=ProgressionPlayerElementController,ProgressionPlayerElementController.prototype.isCorrect=function(){return!0},ProgressionPlayerElementController.prototype.markAsWrongAnswer=function(){this._$element.addClass("wrong-answer")},ProgressionPlayerElementController.prototype.isInvalidAnswer=function(){return!1},ProgressionPlayerElementController.prototype.markAsInvalidAnswer=function(){this._$element.addClass("invalid-answer")},ProgressionPlayerElementController.prototype.userAnswer=function(){return{id:this._elementRendered.id,userAnswer:this._elementSpecificUserAnswer()}},ProgressionPlayerElementController.prototype._elementSpecificUserAnswer=function(){return""},ProgressionPlayerElementController.prototype.expectedAnswer=function(){return{id:this._elementRendered.id,expectedAnswer:this._elementSpecificExpectedAnswer()}},ProgressionPlayerElementController.prototype._elementSpecificExpectedAnswer=function(){return""},ProgressionPlayerElementController.prototype.removeInvalidAnswerStatus=function(){this._$element.removeClass("invalid-answer")},ProgressionPlayerElementController.prototype.disable=function(){},ProgressionPlayerElementController.prototype.enable=function(){},ProgressionPlayerElementController.prototype.doesSupportFocus=!1,ProgressionPlayerElementController.prototype.focus=function(){},ProgressionPlayerElementController.prototype.isAssessedForCorrectness=!1,ProgressionPlayerElementController.prototype.hasElementId=function(a){return this._elementRendered.id===a},ProgressionPlayerElementController.prototype.setAnswer=function(a){}}function ProgressionQuestionElements(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(a&&c&&d){var e=c.usedElements.concat(d.usedElements);a.filter(function(a){return e.includes(a.id)}).forEach(function(a){return b.push(a.clone())}),this._addElementVariants(c.elementVariants),this._addElementVariants(d.elementVariants)}}function unescapeHTMLFromJSON(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;switch(void 0===a?"undefined":_typeof(a)){case"string":b&&c&&(b[c]=$("<div/>").html(a).text());break;case"object":a&&Object.keys(a).forEach(function(b){unescapeHTMLFromJSON(a[b],a,b)})}return a}function makeA11yListTableWords(a){var b=a.isFirstColumnHeader,c=a.isFirstRowHeader,d=a.tableData,e=d.length-(c?1:0),f=d[0].length-(b?1:0),g=e+" row"+(1===e?"":"s")+", "+f+" column"+(1===f?"":"s"),h=require("utilities"),i=h.escapeHTML;return g+"<ol>"+d.map(function(a,b){return a.map(function(a,c){return{cell:a,colName:i(d[0][c].content),rowName:i(d[b][0].content)}})}).flat().filter(function(a){return!a.cell.isHeader}).map(function(a){var d=a.cell.content,e=a.colName,f=a.rowName,g=b?f+" row":"",h=c?e+" column":"",j="";return g?(j=g,h&&(j+=", "+h)):h&&(j=h),"<li>"+j+(j?": ":"")+i(d)+"</li>"}).join("\n")+"</ol>"}function makeViolation(a){return"<strong>"+a+"</strong>"}function makeA11yListWords(a){var b=typeToWordsProperty[a.type.toLowerCase()],c=require("utilities"),d=c.escapeHTML,e=d(a[b]),f=!1;if("table"===a.type)e=makeA11yListTableWords(a);else if(e){var g=require("ProgressionUtilities").create(),h=g.latexInText;["alt","ariaLabel"].includes(b)&&h(e)&&(e+=" "+makeViolation("Contains LaTex but shouldn't"),f=!0)}else b in propertyToDescription&&(e=makeViolation("Missing "+propertyToDescription[b]),f=!0);return{words:e,violation:f}}function makeA11yPreview(a){var b=a.elements,c=a.explanation,d=b.slice().reverse().filter(function(a){return!a.ariaHidden}).map(function(a){var b=a.type.charAt(0).toUpperCase()+a.type.slice(1),c=makeA11yListWords(a);return{preview:"<li>"+b+": "+c.words+"</li>",violation:c.violation}}),e=d.map(function(a){return a.preview}).join("\n"),f=require("ProgressionUtilities").create(),g=f.getExplanationImageRegex,h=f.latexInText,i=g(),j=Array.from(c.matchAll(new RegExp(i,"g"))),k=j.filter(function(a){return!a[6]}).map(function(a){return"<li>"+a[0]+"</li>"}).join("\n"),l=k.length?"<p>Explanation image(s) "+makeViolation("missing a11y alt text")+":</p><ol>"+k+"</ol>":"",m=require("utilities"),n=m.escapeHTML,o=j.filter(function(a){return h(a[6]||"")}).map(function(a){return"<li>"+n(a[0])+"</li>"}).join("\n");return l+=o.length?"<p>Explanation image(s) containing "+makeViolation("LaTeX in the a11y alt text")+" but shouldn't:</p><ol>"+o+"</ol>":"","<p>"+(d.some(function(a){return a.violation})||k.length||o.length?"Each a11y violation is "+makeViolation("bold")+".":"No a11y violations detected.")+"</p>\n<p>Approximation of what a screenreader reads to a user. Is the order logical?</p>\n<ol>\n"+e+"\n</ol>\n"+l}var module={},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();Controllers.prototype=new Array,Controllers.prototype.constructor=Controllers,Controllers.prototype.empty=function(){this.forEach(function(a){a.destroy()}),this.length=0},Controllers.prototype.disable=function(){this.forEach(function(a){a.disable()})},Controllers.prototype.enable=function(){this.forEach(function(a){a.enable()})},Controllers.prototype.focus=function(){var a=this.find(function(a){return a.doesSupportFocus});a&&a.focus()},Controllers.prototype.isCorrect=function(){var a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],b=this.filter(function(a){return!a.isCorrect()});return a&&b.forEach(function(a){return a.markAsWrongAnswer()}),0===b.length},Controllers.prototype.isInvalidAnswer=function(){var a=this.filter(function(a){return a.isInvalidAnswer()});return a.forEach(function(a){a.markAsInvalidAnswer()}),a.length>0},Controllers.prototype.getControllersAssessedForCorrectness=function(){return this.filter(function(a){return a.isAssessedForCorrectness})},Controllers.prototype.userAnswer=function(){return this.getControllersAssessedForCorrectness().map(function(a){return a.userAnswer()})},Controllers.prototype.expectedAnswer=function(){return this.getControllersAssessedForCorrectness().map(function(a){return a.expectedAnswer()})},Controllers.prototype.removeInvalidAnswerStatus=function(){this.forEach(function(a){return a.removeInvalidAnswerStatus()})},Controllers.prototype.setAnswers=function(a){var b=this;a.forEach(function(a){var c=a.userAnswer;if(c){var d=b.find(function(b){return b.hasElementId(a.id)});d&&d.setAnswer(c)}})};var ElementCheckboxController=function a(){var b=this;_classCallCheck(this,a);for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];0!==d.length&&(ProgressionPlayerElementController.prototype.constructor.apply(this,d),this.render(),this._$element.click(function(){b._$input.prop("disabled")||b._$input.prop("checked",!b._$input.prop("checked"))}))},ElementDropdownController=function a(){_classCallCheck(this,a);for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];if(0!==c.length){ProgressionPlayerElementController.prototype.constructor.apply(this,c),this._elementRendered.options.forEach(function(a){a.isSelected=a.isDefault});var e=this._elementRendered.optionOrderingMethod,f=this._elementRendered.options.shift();e.includes("sort")?(this._elementRendered.options.sort(function(a,b){var c=0;return a.text>b.text?c=1:a.text<b.text&&(c=-1),c}),"reverse-sort"===e&&this._elementRendered.options.reverse()):"random"===e&&require("utilities").shuffleArray(this._elementRendered.options),this._elementRendered.options.unshift(f),this.render()}},ElementTableController=function a(){_classCallCheck(this,a),this.clipboard=null;for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];0!==c.length&&(ProgressionPlayerElementController.prototype.constructor.apply(this,c),this.render())};module.exports={create:function(){return buildDelayedPrototypes(),new ProgressionPlayer},dependencies:{tools:["utilities","progressionTool","ProgressionUtilities"],vendorJS:["clipboard.min.js"]},runTests:function(){buildDelayedPrototypes()}};var ProgressionQuestion=function(){function a(b,c,d,e,f){_classCallCheck(this,a),this.elements=b,this.explanation=c,this.height=d,this.width=e,this.levelIndex=f}return _createClass(a,[{key:"toJSON",value:function(){return{elements:this.elements.toJSON(),explanation:this.explanation,height:this.height,width:this.width,levelIndex:this.levelIndex}}}]),a}();ProgressionQuestionElements.prototype=[],ProgressionQuestionElements.prototype.constructor=ProgressionQuestionElements,ProgressionQuestionElements.prototype._addElementVariants=function(a){var b=this;a.forEach(function(a){return b._getElementWithId(a.id).mergeElementVariant(a)})},ProgressionQuestionElements.prototype._getElementWithId=function(a){return this.find(function(b){return b.id===a})},ProgressionQuestionElements.prototype.toJSON=function(){return this.map(function(a){return a.toJSON()})},ProgressionQuestionElements.prototype.fromJSON=function(a){var b=require("ProgressionUtilities").create();this.push.apply(this,_toConsumableArray(a.map(function(a){return b.createElementByProperties(a)})))};var ProgressionQuestionFactory=function(){function a(b,c){_classCallCheck(this,a),this._progression=require("ProgressionUtilities").create().createProgression(b);var d=require("utilities");this._progression.levels.forEach(function(a){a.questions=d.getCarousel(a.questions)}),this._inBuilderMode=c}return _createClass(a,[{key:"make",value:function(a){var b=this,c=this._progression,d=c.levels[a],e=d.questions.getValue(),f=new ProgressionQuestionElements(c.elements,d,e),g=require("ProgressionUtilities").create(),h=g.getMostSpecificProperty,i=h("height",c,d,e),j=h("width",c,d,e),k=[c.explanation,d.explanation,e.explanation],l=k.filter(function(a){return Boolean(a)}).join("\n"),m=c.code,n=d.code,o=e.code,p=m+"\n",q=n+"\n",r=null;try{r=g.makePythonModule(p,q,o)}catch(a){var s=g.reviseLineNumberInErrorMessage(a.toString(),p,q);if(this._inBuilderMode)throw alert(s),a;require("zyWebErrorManager").postError(s)}return l=g.replaceStringVariables(l,r),f.forEach(function(a){a.updateWithCode(r,b._inBuilderMode)}),new ProgressionQuestion(f,l,i,j,a)}},{key:"numberOfLevels",value:function(){return this._progression.levels.length}}]),a}(),typeToWordsProperty={checkbox:"label",dropdown:"ariaLabel",image:"alt",shortanswer:"ariaLabel",text:"text"},propertyToDescription={label:"a label",alt:"alt text or being hidden",ariaLabel:"a11y label"};exports.default=module.exports});