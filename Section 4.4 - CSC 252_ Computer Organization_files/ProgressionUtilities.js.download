define("ProgressionUtilities",["exports"],function(exports){function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function ProgressionUtilities(){buildStyleEscapeDictionary(),this.ProgressionUtilities=this.ProgressionUtilities||{},this.ProgressionUtilities.ElementCheckbox=Handlebars.template({1:function(a,b,c,d,e){return" selected"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:a.nullContext||{},i=c.helperMissing,j="function",k=a.escapeExpression;return"<div class='element"+(null!=(f=c.if.call(h,null!=(f=null!=b?b.element:b)?f.isSelected:f,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+" zb-checkbox checkbox-element label-present secondary' "+(null!=(g=null!=(g=c.style||(null!=b?b.style:b))?g:i,f=(void 0===g?"undefined":_typeof(g))===j?g.call(h,{name:"style",hash:{},data:e}):g)?f:"")+">\n    <input id="+k((g=null!=(g=c.elementHtmlId||(null!=b?b.elementHtmlId:b))?g:i,(void 0===g?"undefined":_typeof(g))===j?g.call(h,{name:"elementHtmlId",hash:{},data:e}):g))+' type="checkbox" value="false">\n        <label for='+k((g=null!=(g=c.elementHtmlId||(null!=b?b.elementHtmlId:b))?g:i,(void 0===g?"undefined":_typeof(g))===j?g.call(h,{name:"elementHtmlId",hash:{},data:e}):g))+">"+(null!=(f=a.lambda(null!=(f=null!=b?b.element:b)?f.labelHTML:f,b))?f:"")+"</label>\n    </input>\n</div>\n"},useData:!0}),this.ProgressionUtilities.ElementDropdown=Handlebars.template({1:function(a,b,c,d,e){return" selected"},3:function(a,b,c,d,e){var f,g,h=null!=b?b:a.nullContext||{},i=c.helperMissing,j="function",k=a.escapeExpression;return"            <option value='"+k((g=null!=(g=c.text||(null!=b?b.text:b))?g:i,(void 0===g?"undefined":_typeof(g))===j?g.call(h,{name:"text",hash:{},data:e}):g))+"'"+(null!=(f=c.if.call(h,null!=b?b.isSelected:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+(null!=(f=c.if.call(h,null!=b?b.isInvalidOption:b,{name:"if",hash:{},fn:a.program(4,e,0),inverse:a.noop,data:e}))?f:"")+">"+k((g=null!=(g=c.text||(null!=b?b.text:b))?g:i,(void 0===g?"undefined":_typeof(g))===j?g.call(h,{name:"text",hash:{},data:e}):g))+"</option>\n"},4:function(a,b,c,d,e){return" disabled"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:a.nullContext||{};return"<div class='element"+(null!=(f=c.if.call(h,null!=(f=null!=b?b.element:b)?f.isSelected:f,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+" dropdown' "+(null!=(g=null!=(g=c.style||(null!=b?b.style:b))?g:c.helperMissing,f="function"==typeof g?g.call(h,{name:"style",hash:{},data:e}):g)?f:"")+">\n    <select aria-label='"+a.escapeExpression(a.lambda(null!=(f=null!=b?b.element:b)?f.ariaLabel:f,b))+"'>\n"+(null!=(f=c.each.call(h,null!=(f=null!=b?b.element:b)?f.options:f,{name:"each",hash:{},fn:a.program(3,e,0),inverse:a.noop,data:e}))?f:"")+"    </select>\n</div>"},useData:!0}),this.ProgressionUtilities.ElementImage=Handlebars.template({1:function(a,b,c,d,e){return" selected"},3:function(a,b,c,d,e){return"keep-height-ratio "},5:function(a,b,c,d,e){return"keep-width-ratio"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:a.nullContext||{};return'<div aria-hidden="'+a.escapeExpression(a.lambda(null!=(f=null!=b?b.element:b)?f.ariaHidden:f,b))+"\" class='element"+(null!=(f=c.if.call(h,null!=(f=null!=b?b.element:b)?f.isSelected:f,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+"' "+(null!=(g=null!=(g=c.style||(null!=b?b.style:b))?g:c.helperMissing,f="function"==typeof g?g.call(h,{name:"style",hash:{},data:e}):g)?f:"")+">\n    <img alt='Image loading...'\n         class=\""+(null!=(f=c.if.call(h,null!=(f=null!=b?b.element:b)?f.keepHeightRatio:f,{name:"if",hash:{},fn:a.program(3,e,0),inverse:a.noop,data:e}))?f:"")+(null!=(f=c.if.call(h,null!=(f=null!=b?b.element:b)?f.keepWidthRatio:f,{name:"if",hash:{},fn:a.program(5,e,0),inverse:a.noop,data:e}))?f:"")+'"/>\n</div>\n'},useData:!0}),this.ProgressionUtilities.ElementShortAnswer=Handlebars.template({1:function(a,b,c,d,e){return" selected"},3:function(a,b,c,d,e){return"number"},5:function(a,b,c,d,e){return"text"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:a.nullContext||{},i=c.helperMissing,j=a.lambda,k=a.escapeExpression;return"<div class='element"+(null!=(f=c.if.call(h,null!=(f=null!=b?b.element:b)?f.isSelected:f,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+" short-answer' "+(null!=(g=null!=(g=c.style||(null!=b?b.style:b))?g:i,f="function"==typeof g?g.call(h,{name:"style",hash:{},data:e}):g)?f:"")+">\n    <input aria-label='"+k(j(null!=(f=null!=b?b.element:b)?f.ariaLabel:f,b))+"' type='"+(null!=(f=(c.ifCond||b&&b.ifCond||i).call(h,null!=(f=null!=b?b.element:b)?f.assessmentMethod:f,"===","numericalMatch",{name:"ifCond",hash:{},fn:a.program(3,e,0),inverse:a.program(5,e,0),data:e}))?f:"")+"' placeholder='"+k(j(null!=(f=null!=b?b.element:b)?f.placeholder:f,b))+"'>\n</div>"},useData:!0}),this.ProgressionUtilities.ElementStyle=Handlebars.template({1:function(a,b,c,d,e){var f,g=a.escapeExpression;return g((f=null!=(f=c.key||e&&e.key)?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:a.nullContext||{},{name:"key",hash:{},data:e}):f))+": "+g(a.lambda(b,b))+";"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return"style='"+(null!=(f=c.each.call(null!=b?b:a.nullContext||{},null!=b?b.style:b,{name:"each",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+"'"},useData:!0}),this.ProgressionUtilities.ElementTable=Handlebars.template({1:function(a,b,c,d,e){return" selected"},3:function(a,b,c,d,e){return" as-spreadsheet"},5:function(a,b,c,d,e){return"class='fix-width'"},7:function(a,b,c,d,e){var f;return"            <tr>\n                <td>"+a.escapeExpression(a.lambda(null!=(f=null!=(f=null!=b?b.element:b)?f.tableData:f)?f.data:f,b))+"</td>\n            </tr>\n"},9:function(a,b,c,d,e,f,g){var h;return null!=(h=c.each.call(null!=b?b:a.nullContext||{},null!=(h=null!=b?b.element:b)?h.tableData:h,{name:"each",hash:{},fn:a.program(10,e,1,f,g),inverse:a.noop,data:e,blockParams:f}))?h:""},10:function(a,b,c,d,e,f,g){var h,i=null!=b?b:a.nullContext||{};return"                <tr"+(null!=(h=c.if.call(i,null!=(h=null!=g[1]?g[1].element:g[1])?h.equalHeightRows:h,{name:"if",hash:{},fn:a.program(11,e,0,f,g),inverse:a.noop,data:e,blockParams:f}))?h:"")+">\n"+(null!=(h=c.each.call(i,f[0][0],{name:"each",hash:{},fn:a.program(13,e,1,f,g),inverse:a.noop,data:e,blockParams:f}))?h:"")+"                </tr>\n"},11:function(a,b,c,d,e,f,g){var h;return' style="height: '+a.escapeExpression(a.lambda(null!=(h=null!=g[1]?g[1].element:g[1])?h.rowHeight:h,b))+'px;"'},13:function(a,b,c,d,e,f){var g,h=null!=b?b:a.nullContext||{};return"                        <t"+(null!=(g=c.if.call(h,null!=(g=f[0][0])?g.isHeader:g,{name:"if",hash:{},fn:a.program(14,e,0,f),inverse:a.program(16,e,0,f),data:e,blockParams:f}))?g:"")+" style='"+(null!=(g=c.each.call(h,null!=(g=f[0][0])?g.style:g,{name:"each",hash:{},fn:a.program(18,e,0,f),inverse:a.noop,data:e,blockParams:f}))?g:"")+"'>"+(null!=(g=a.lambda(null!=(g=f[0][0])?g.contentHTML:g,b))?g:"")+"</t"+(null!=(g=c.if.call(h,null!=(g=f[0][0])?g.isHeader:g,{name:"if",hash:{},fn:a.program(14,e,0,f),inverse:a.program(16,e,0,f),data:e,blockParams:f}))?g:"")+">\n"},14:function(a,b,c,d,e){return"h"},16:function(a,b,c,d,e){return"d"},18:function(a,b,c,d,e){var f,g=a.escapeExpression;return g((f=null!=(f=c.key||e&&e.key)?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:a.nullContext||{},{name:"key",hash:{},data:e}):f))+": "+g(a.lambda(b,b))+";"},20:function(a,b,c,d,e){var f;return null!=(f=c.if.call(null!=b?b:a.nullContext||{},null!=(f=null!=b?b.element:b)?f.isSpreadsheet:f,{name:"if",hash:{},fn:a.program(21,e,0),inverse:a.noop,data:e}))?f:""},21:function(a,b,c,d,e){return"            <button>Copy sheet</button>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e,f,g){var h,i,j=null!=b?b:a.nullContext||{};return'<div aria-hidden="'+a.escapeExpression(a.lambda(null!=(h=null!=b?b.element:b)?h.ariaHidden:h,b))+"\" class='element"+(null!=(h=c.if.call(j,null!=(h=null!=b?b.element:b)?h.isSelected:h,{name:"if",hash:{},fn:a.program(1,e,0,f,g),inverse:a.noop,data:e,blockParams:f}))?h:"")+" table table-element"+(null!=(h=c.if.call(j,null!=(h=null!=b?b.element:b)?h.isSpreadsheet:h,{name:"if",hash:{},fn:a.program(3,e,0,f,g),inverse:a.noop,data:e,blockParams:f}))?h:"")+"' "+(null!=(i=null!=(i=c.style||(null!=b?b.style:b))?i:c.helperMissing,h="function"==typeof i?i.call(j,{name:"style",hash:{},data:e,blockParams:f}):i)?h:"")+">\n    <table "+(null!=(h=c.if.call(j,null!=(h=null!=b?b.element:b)?h.fixWidth:h,{name:"if",hash:{},fn:a.program(5,e,0,f,g),inverse:a.noop,data:e,blockParams:f}))?h:"")+">\n"+(null!=(h=c.if.call(j,null!=(h=null!=(h=null!=b?b.element:b)?h.tableData:h)?h.data:h,{name:"if",hash:{},fn:a.program(7,e,0,f,g),inverse:a.program(9,e,0,f,g),data:e,blockParams:f}))?h:"")+"    </table>\n"+(null!=(h=c.unless.call(j,null!=b?b.noCopyButton:b,{name:"unless",hash:{},fn:a.program(20,e,0,f,g),inverse:a.noop,data:e,blockParams:f}))?h:"")+"</div>\n"},useData:!0,useDepths:!0,useBlockParams:!0}),this.ProgressionUtilities.ElementText=Handlebars.template({1:function(a,b,c,d,e){return" selected"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=a.lambda,i=null!=b?b:a.nullContext||{};return'<div aria-hidden="'+a.escapeExpression(h(null!=(f=null!=b?b.element:b)?f.ariaHidden:f,b))+"\" class='element"+(null!=(f=c.if.call(i,null!=(f=null!=b?b.element:b)?f.isSelected:f,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+" text-element' "+(null!=(g=null!=(g=c.style||(null!=b?b.style:b))?g:c.helperMissing,f="function"==typeof g?g.call(i,{name:"style",hash:{},data:e}):g)?f:"")+">"+(null!=(f=h(null!=(f=null!=b?b.element:b)?f.html:f,b))?f:"")+"</div>"},useData:!0}),this.ProgressionUtilities.QuestionArea=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"<link href='https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i' rel='stylesheet'>\n<div class='question-area'>\n    <div class='draggable-area'></div>\n</div>\n"},useData:!0}),this.templates=this[this._name],this.colorEscapeDictionary=colorEscapeDictionary,require("utilities").addIfConditionalHandlebars()}function isExplanationElementRemaining(a,b){return a.some(function(a){return a.isInstanceRemaining(b)})}function getExplanationElementMatches(a,b){return a.map(function(a){return a.getMatch(b)})}function PropertyAndType(a,b){this.property=a,this.type=b}function testProperties(a,b,c){QUnit.test(c+" Creation",function(d){b.forEach(function(b){var e=b.property,f=b.type;d.ok(e in a,c+" has property "+e),d.equal(toType(a[e]),f,c+" property "+e+" is a "+f)})})}function numberOfLinesOfCode(a){return a.split("\n").length-1}function getElementClassNameByType(a){var b="";switch(a.toLowerCase()){case"dropdown":b="ElementDropdown";break;case"image":b="ElementImage";break;case"shortanswer":b="ElementShortAnswer";break;case"text":b="ElementText";break;case"table":b="ElementTable";break;case"checkbox":b="ElementCheckbox";break;default:throw new Error("Unrecognized type: "+a)}return b}function getElementClassByType(type){var className=getElementClassNameByType(type);return eval(className)}function escapeStyleValues(a){var b={};for(var c in a){var d=a[c];for(var e in colorEscapeDictionary)if("string"==typeof d){var f=colorEscapeDictionary[e];d=d.replace(e,f)}b[c]=d}return b}function buildStyleEscapeDictionary(){var a=require("utilities");colorEscapeDictionary={"zyante-black":a.zyanteGray,"zyante-gray":"#9e9e9e","zyante-dark-blue":a.zyanteDarkBlue}}function downloadImage(a,b,c){a.on("error",function(){b.length>0?(b.shift(),downloadImage(a,b,c)):a.attr("alt",c)}).attr("src",b[0])}function replaceStringVariables(a,b){return require("utilities").replaceStringVariables(a,b)}function getPythonVariableName(a){var b=require("utilities").getPythonNotation(a),c=/^\$\{(\w+)\}$/,d=c.exec(b);return d&&d[1]||""}function pythonVariableIsList(a,b){var c=b.tp$getattr(a);return c&&"list"===c.tp$name}function getValuesFromPythonList(a,b){return b.tp$getattr(a).v.map(function(a){return a.v})}function isTwoDimensionalList(a,b){var c=b.tp$getattr(a);return pythonVariableIsList(a,b)&&c.v[0]&&"list"===c.v[0].tp$name}function getTableDataFromList(a,b){var c=b.tp$getattr(a);return new TwoDimensionalList(c)}function spreadsheetColumnName(a){var b="";if(a>0)for(var c=26,d="A".charCodeAt(0),e=a-1;e>=0;){var f=String.fromCharCode(e%c+d);b=f+b,e=Math.floor(e/c)-1}return b}function addSpreadsheetHeaders(a){var b=a[0].length+1;a.forEach(function(a,b){return a.unshift(String(b+1))});var c=require("utilities").createArrayOfSizeN(b).map(function(a,b){return spreadsheetColumnName(b)});a.unshift(c)}function removeSpreadsheetHeaders(a,b){"width"!==b&&a.shift(),a.forEach(function(a){return a.shift()})}function isValueDefined(a,b){var c=!1;if(a){var d=a[b],e=null===d,f=void 0===d,g=""===d;c=!(e||f||g)}return c}function makeImageURLs(a,b){return[a.getVersionedImage(b),(a.getStaticResource||a.getDependencyURL).call(a,"gdrive_images/"+b),"https://drive.google.com/uc?export=download&id="+b]}function makeImageElementForExplanation(a,b,c){var d=a[1]?parseInt(a[1],10):0,e=a[2]?parseInt(a[2],10):0,f=a[3],g=makeImageURLs(b,f),h={class:"explanation-image","image-id":f,src:g[0]};c&&(h.onerror="this.onerror=null; this.src='"+g[1]+"';");var i=$("<img>",h);return 0!==d&&i.width(d),0!==e&&i.height(e),a[6]&&i.attr("alt",a[6]),i}function convertStringInto2DArray(a){return a.split("\n").map(function(a){return a.split("&")})}function makeSpreadsheetElementForExplanation(a){var b=convertStringInto2DArray(a[4]);addSpreadsheetHeaders(b);var c=b.map(function(a){return a.map(function(){return"default"})});if(a[5]){c=convertStringInto2DArray(a[6]),c.map(function(a){return a.unshift("default")});var d=require("utilities").createArrayOfSizeN(b.length).map(function(){return"default"});c.unshift(d)}var e=b.map(function(a,b){return a.map(function(a,d){var e=c[b][d],f=fillColorModalNameToXMLName[e],g={};if(f){var h=require("utilities")[f];g["background-color"]=h}return{content:a,isHeader:0===b||0===d,style:g}})}),f=a[3]?parseInt(a[3],10):null,g=a[2]?parseInt(a[2],10):null,h=a[1]?parseInt(a[1],10):null,i={};f&&(i["font-size"]=f+"px"),g&&(i.height=g+"px"),h&&(i.width=h+"px");var j=new ElementTable({tableData:e,isSpreadsheet:!0,style:i}),k=(new ProgressionUtilities).templates,l=k.ElementStyle({style:i});j.prepareForRendering();var m=k.ElementTable({element:j,style:l,noCopyButton:!0});return $(m)}function makeTableElementForExplanation(a){var b=Boolean(a[1]),c=Boolean(a[2]),d=convertStringInto2DArray(a[6]),e=d.map(function(a,d){return a.map(function(a,e){var f=b&&0===d,g=c&&0===e;return{content:a,isHeader:f||g}})}),f=a[5]?parseInt(a[5],10):null,g=a[4]?parseInt(a[4],10):null,h=a[3]?parseInt(a[3],10):null,i={};f&&(i["font-size"]=f+"px"),g&&(i.height=g+"px"),h&&(i.width=h+"px");var j=new ElementTable({tableData:e,style:i,isFirstRowHeader:b,isFirstColumnHeader:c}),k=(new ProgressionUtilities).templates,l=k.ElementStyle({style:i});j.prepareForRendering();var m=k.ElementTable({element:j,style:l,noCopyButton:!0});return $(m)}function backtickTokenize(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=a[c+1],f=d;"\\"===d&&"`"===e&&(f="\\`",c++),b.push(f)}return b}function backtickTokensToParts(a){for(var b=!1,c=[""];a.length;){var d=a.shift();"`"===d?(b=!b,c.push("")):c[c.length-1]+=d}return b&&(c[c.length-2]+="`"+c[c.length-1],c.pop()),c}function backtickPartsToNodes(a){return a.map(function(a,b){var c=b%2,d=c?"code":"span",e=document.createElement(d);return e.textContent=a,e})}function replaceBackticks(a){var b=backtickTokenize(a),c=backtickTokensToParts(b),d=backtickPartsToNodes(c);return $("<div>").html($(d)).prop("innerHTML")}function createParagraphTag(a){return $("<p>").html(replaceBackticks(a))}var module={},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_get=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;if(void 0!==g)return g.call(d)},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),Element=function(){function a(b){_classCallCheck(this,a),b&&(this.id=b.id,this.isInEditMode=b.isInEditMode,this.isSelected=b.isSelected,this.name=b.name,this.style=b.style,this.type=b.type)}return _createClass(a,[{key:"clone",value:function(){throw new Error("Cannot clone Element.")}},{key:"toJSON",value:function(){return{id:this.id,isInEditMode:this.isInEditMode,isSelected:this.isSelected,name:this.name,style:$.extend(!0,{},this.style),type:this.type}}},{key:"mergeElementVariant",value:function(a){for(var b in a)this._setProperty(b,a[b])}},{key:"_setProperty",value:function(a,b){"style"===a?$.extend(this.style,b):this[a]=b}},{key:"updateWithCode",value:function(a,b){}},{key:"prepareForRendering",value:function(){}}]),a}(),ElementCheckbox=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.correctAnswerIsCheckedString=a.correctAnswerIsCheckedString||"",c.correctAnswerIsChecked=!1,c.label=a.label||"",c.labelHTML=null,c.setCorrectAnswerIsChecked(c.correctAnswerIsCheckedString),c}return _inherits(b,a),_createClass(b,[{key:"setCorrectAnswerIsChecked",value:function(a){var b=["False","false","","0"];this.correctAnswerIsChecked=!b.includes(a)}},{key:"clone",value:function(){return new b(this.toJSON())}},{key:"toJSON",value:function(){var a=Element.prototype.toJSON.call(this);return a.correctAnswerIsCheckedString=this.correctAnswerIsCheckedString,a.label=this.label,a}},{key:"updateWithCode",value:function(a,b){this.label=replaceStringVariables(this.label,a);var c=replaceStringVariables(this.correctAnswerIsCheckedString,a);if(b){var d=["False","True"].includes(this.correctAnswerIsCheckedString),e=["0","1"].includes(c);if(!(d||e)){var f="Checkbox's correctness must be True or False. Checkbox that does not: "+this.label;throw window.alert(f),new Error(f)}}this.setCorrectAnswerIsChecked(c)}},{key:"prepareForRendering",value:function(){this.labelHTML=replaceBackticks(this.label)}}]),b}(Element),ElementController=function(){function a(b,c,d,e,f){_classCallCheck(this,a),0!==arguments.length&&(this._elementRendered=b,this._$questionArea=c,this._templates=d,this._parentResource=e,this._progressionTool=f,this._$element=null)}return _createClass(a,[{key:"render",value:function(){this._elementRendered.style=escapeStyleValues(this._elementRendered.style),"transform"in this._elementRendered.style&&(this._elementRendered.style["-ms-transform"]=this._elementRendered.style.transform,this._elementRendered.style["-webkit-transform"]=this._elementRendered.style.transform);var a=this._templates.ElementStyle({style:this._elementRendered.style}),b=require("ProgressionUtilities").create().getElementClassNameByType(this._elementRendered.type),c=this._makeElementToRender();c.prepareForRendering();var d=this._templates[b]({element:c,elementHtmlId:this._parentResource.resourceId+"-"+this._elementRendered.id,style:a});this._$questionArea.append(d),this._$element=this._$questionArea.children().last()}},{key:"destroy",value:function(){this._$element&&this._$element.remove()}},{key:"_makeElementToRender",value:function(){return this._elementRendered}}]),a}(),ElementDropdown=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a)),d=a.options?a.options.slice():[];return c.options=d.map(function(a){return new ElementDropdownOption(a)}),c.optionOrderingMethod=a.optionOrderingMethod||"none",c.ariaLabel=a.ariaLabel||"",c}return _inherits(b,a),_createClass(b,[{key:"_setProperty",value:function(a,b){"options"===a?this.options=b.map(function(a){return new ElementDropdownOption(a)}):Element.prototype._setProperty.call(this,a,b)}},{key:"clone",value:function(){return new b(this.toJSON())}},{key:"toJSON",value:function(){var a=Element.prototype.toJSON.call(this);return a.options=this.options.map(function(a){return a.toJSON()}),a.optionOrderingMethod=this.optionOrderingMethod,a.ariaLabel=this.ariaLabel,a}},{key:"updateWithCode",value:function(a){this.ariaLabel=replaceStringVariables(this.ariaLabel,a);var b=[];this.options.forEach(function(c){var d=getPythonVariableName(c.text);if(c.isPythonList)if(pythonVariableIsList(d,a)){var e=getValuesFromPythonList(d,a);b=e.map(function(a){var b=c.clone();return b.text=a,b.isPythonList=!1,b})}else alert("Error: "+d+" is not a 1D list variable.");else c.updateWithCode(a)}),this.options=this.options.filter(function(a){return!a.isPythonList}),this.options=this.options.concat(b)}}]),b}(Element),ElementDropdownOption=function(){function a(b){_classCallCheck(this,a),this.isCorrectOption=b.isCorrectOption,this.isDefault=b.isDefault,this.isInvalidOption=b.isInvalidOption,this.isSelected=b.isSelected,this.isPythonList=b.isPythonList||!1;var c=this.isDefault?"Pick":"",d=require("utilities").getPythonNotation(b.text),e=this.isPythonList?d:b.text;this.text=e||c}return _createClass(a,[{key:"toJSON",value:function(){return{text:this.text,isCorrectOption:this.isCorrectOption,isDefault:this.isDefault,isInvalidOption:this.isInvalidOption,isSelected:this.isSelected,isPythonList:this.isPythonList}}},{key:"clone",value:function(){return new a(this.toJSON())}},{key:"updateWithCode",value:function(a){this.text=replaceStringVariables(this.text,a)}}]),a}(),ElementImage=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.alt=a.alt||"",c.ariaHidden=a.ariaHidden||!1,c.controlHeightWidthPerQuestion=a.controlHeightWidthPerQuestion||!1,c.imageID=a.imageID||"",c._updateKeepRatioProperties(),c}return _inherits(b,a),_createClass(b,[{key:"clone",value:function(){return new b(this.toJSON())}},{key:"toJSON",value:function(){var a=Element.prototype.toJSON.call(this);return a.alt=this.alt,a.ariaHidden=this.ariaHidden,a.controlHeightWidthPerQuestion=this.controlHeightWidthPerQuestion,a.imageID=this.imageID,a}},{key:"_updateKeepRatioProperties",value:function(){this.keepHeightRatio="auto"===this.style.height,this.keepWidthRatio="auto"===this.style.width}},{key:"_setProperty",value:function(a,c){_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"_setProperty",this).call(this,a,c),this._updateKeepRatioProperties()}},{key:"updateWithCode",value:function(a){this.alt=replaceStringVariables(this.alt,a),this.imageID=replaceStringVariables(this.imageID,a)}}]),b}(Element),ElementShortAnswer=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.ariaLabel=a.ariaLabel||"",c.assessmentMethod=a.assessmentMethod||"stringMatch",c.assessmentProperties=a.assessmentProperties||{},c.correctAnswers=a.correctAnswers?a.correctAnswers.slice():[],c.placeholder=a.placeholder||"",c}return _inherits(b,a),_createClass(b,[{key:"clone",value:function(){return new b(this.toJSON())}},{key:"toJSON",value:function(){var a=Element.prototype.toJSON.call(this);return a.ariaLabel=this.ariaLabel,a.assessmentMethod=this.assessmentMethod,a.assessmentProperties=$.extend(!0,{},this.assessmentProperties),a.correctAnswers=this.correctAnswers.slice(),a.placeholder=this.placeholder,a}},{key:"updateWithCode",value:function(a){this.ariaLabel=replaceStringVariables(this.ariaLabel,a),this.placeholder=replaceStringVariables(this.placeholder,a);var b=this.correctAnswers.map(function(b){var c=/\$\{(\w+)\}/g.exec(b),d=c&&c.length>1?c[1]:b;return pythonVariableIsList(d,a)?getValuesFromPythonList(d,a):replaceStringVariables(b,a)}),c=b.reduce(function(a,b){return a.concat(b)},[]);this.correctAnswers=c.map(function(a){return a.toString()})}}]),b}(Element),ElementTable=function(a){function b(a){var c=a.ariaHidden,d=void 0!==c&&c,e=a.equalHeightRows,f=void 0!==e&&e,g=a.isFirstColumnHeader,h=void 0!==g&&g,i=a.isFirstRowHeader,j=void 0!==i&&i,k=a.isSpreadsheet,l=void 0!==k&&k,m=a.listName,n=void 0===m?"":m,o=a.style,p=void 0===o?{}:o,q=a.tableData,r=void 0===q?null:q;_classCallCheck(this,b);var s=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,arguments[0])),t=new ElementTableCell({}),u=[[t,t.clone()],[t.clone(),t.clone()]],v=r||u,w=v.hasOwnProperty("data"),x=n&&""!==n,y=w||x||"string"==typeof v;if(s.ariaHidden=d,s.equalHeightRows=f,s.isFirstColumnHeader=h||l,s.isFirstRowHeader=j||l,s.isSpreadsheet=l,s.style=p,y){var z=w?r.data:n||r;s.tableData={data:require("utilities").getPythonNotation(z)}}else s.fixWidth=v.flat().some(function(a){return a.style&&a.style.width&&""!==a.style.width&&"auto"!==a.style.width}),s.tableData=s.buildTableCells(v);return s.buildRowHeights(),s}return _inherits(b,a),_createClass(b,[{key:"buildRowHeights",value:function(){this.equalHeightRows&&(this.rowHeight=parseFloat(this.style.height)/this.tableData.length)}},{key:"_setProperty",value:function(a,b){"tableData"===a&&Array.isArray(b)?this.tableData=b.map(function(a){return a.map(function(a){return new ElementTableCell(a)})}):"listName"===a&&""!==b?this.tableData={data:require("utilities").getPythonNotation(b)}:Element.prototype._setProperty.call(this,a,b)}},{key:"buildTableCells",value:function(a){var b=this;return a.map(function(a,c){return a.map(function(a,d){var e=new ElementTableCell(a),f=0===c,g=0===d,h=f&&(b.isFirstRowHeader||b.isSpreadsheet),i=g&&(b.isFirstColumnHeader||b.isSpreadsheet);return e.setCellHeader(h||i),!b.isSpreadsheet||!g||a.hasOwnProperty("style")&&a.style.hasOwnProperty("width")||e.setWidth("8%"),e})})}},{key:"clone",value:function(){return new b(this.toJSON())}},{key:"toJSON",value:function(){var a=Element.prototype.toJSON.call(this);return this._isUsingList()?a.tableData={data:this.getListName()}:a.tableData=this.tableData.map(function(a){return a.map(function(a){return a.toJSON()})}),a.ariaHidden=this.ariaHidden,a.equalHeightRows=this.equalHeightRows,a.isFirstColumnHeader=this.isFirstColumnHeader,a.isFirstRowHeader=this.isFirstRowHeader,a.isSpreadsheet=this.isSpreadsheet,a}},{key:"updateWithCode",value:function(a){var b=this;if(this._isUsingList()){var c=getPythonVariableName(this.getListName());if(isTwoDimensionalList(c,a)){var d=getTableDataFromList(c,a);this.isSpreadsheet&&addSpreadsheetHeaders(d.variables),this.tableData=d.variables.map(function(a,c){return a.map(function(a,d){return new ElementTableCell({content:String(a),isHeader:b.isFirstRowHeader&&0===c||b.isFirstColumnHeader&&0===d})})})}else alert("Error: "+c+" is not a 2D list variable.")}else this.tableData.forEach(function(b){return b.forEach(function(b){return b.updateWithCode(a)})});this.buildRowHeights()}},{key:"_isUsingList",value:function(){return this.tableData.hasOwnProperty("data")||!1||"string"==typeof tableData}},{key:"getListName",value:function(){if(this._isUsingList()){var a=this.tableData.hasOwnProperty("data")?this.tableData.data:this.tableData;return require("utilities").getPythonNotation(a)}return""}},{key:"prepareForRendering",value:function(){this._isUsingList()||this.tableData.forEach(function(a){return a.forEach(function(a){return a.prepareForRendering()})})}}]),b}(Element),ElementTableCell=function(){function a(b){var c=b.content,d=void 0===c?"":c,e=b.isHeader,f=void 0!==e&&e,g=b.style,h=void 0===g?null:g;_classCallCheck(this,a),this.content=d||"",this.contentHTML=null,this.isHeader=f,this.style=h||{width:"auto"}}return _createClass(a,[{key:"setCellHeader",value:function(a){this.isHeader=a}},{key:"setWidth",value:function(a){this.style.width=a}},{key:"clone",value:function(){return new a(this.toJSON())}},{key:"toJSON",value:function(){return{content:this.content,style:$.extend(!0,{},this.style)}}},{key:"updateWithCode",value:function(a){var b=this;this.content=replaceStringVariables(this.content,a),Object.entries(this.style).forEach(function(c){var d=_slicedToArray(c,2),e=d[0],f=d[1],g=replaceStringVariables(f,a);"background-color"===e?g=fillColorModalNameToXMLName[g]||g:"width"===e&&(g=isNaN(g)?g:g+"%"),b.style[e]=g})}},{key:"prepareForRendering",value:function(){this.contentHTML=replaceBackticks(this.content)}},{key:"changeToPrintableStyles",value:function(){if(this.style["background-color"]){var a=require("utilities")[this.style["background-color"]];a?this.style["background-color"]=a:delete this.style["background-color"]}}}]),a}(),ElementText=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.ariaHidden=a.ariaHidden||!1,c.text=a.text||"",c.html=null,c}return _inherits(b,a),_createClass(b,[{key:"clone",value:function(){return new b(this.toJSON())}},{key:"toJSON",value:function(){var a=Element.prototype.toJSON.call(this);return a.ariaHidden=this.ariaHidden,a.text=this.text,a}},{key:"updateWithCode",value:function(a){this.text=replaceStringVariables(this.text,a)}},{key:"prepareForRendering",value:function(){this.html=replaceBackticks(this.text)}}]),b}(Element),ElementVariant=function(){function a(b){_classCallCheck(this,a);for(var c in b){var d=b[c];d=isValueDefined(b,c)?d:"","style"===c&&(d=escapeStyleValues(d)),"[object Array]"===Object.prototype.toString.call(d)&&(d=d.slice()),this[c]=d}b.listName&&""!==b.listName&&(this.tableData={data:b.listName})}return _createClass(a,[{key:"clone",value:function(){return new a(this.toJSON())}},{key:"toJSON",value:function(){var a=$.extend(!0,{},this);return a.tableData&&Array.isArray(a.tableData)&&(a.tableData=a.tableData.map(function(a){return a.map(function(a){return $.extend(!0,{},a)})})),a}}]),a}(),Level=function(){function a(b){_classCallCheck(this,a);var c=b.elementVariants||[];this.elementVariants=c.map(function(a){return new ElementVariant(a)});var d=b.questions||[];this.questions=d.map(function(a){return new Question(a)}),this.code=b.code||"",this.explanation=b.explanation||"",this.height=b.height,this.isCollapsed=void 0===b.isCollapsed||b.isCollapsed,this.isSelected=b.isSelected||!1,this.name=b.name,this.usedElements=b.usedElements.slice(),this.width=b.width}return _createClass(a,[{key:"clone",value:function(){return new a(this.toJSON())}},{key:"toJSON",value:function(){return{code:this.code,elementVariants:this.elementVariants.map(function(a){return a.toJSON()}),questions:this.questions.map(function(a){return a.toJSON()}),explanation:this.explanation,height:this.height,isCollapsed:this.isCollapsed,isSelected:this.isSelected,name:this.name,usedElements:this.usedElements.slice(),width:this.width}}}]),a}(),Progression=function(){function a(b){_classCallCheck(this,a);var c=b.elements||[];this.elements=c.map(function(a){return new(getElementClassByType(a.type))(a)});var d=b.levels||[];this.levels=d.map(function(a){return new Level(a)}),this.code=b.code||"",this.explanation=b.explanation||"",this.height=b.height,this.width=b.width,this.isExam=b.isExam||!1}return _createClass(a,[{key:"getSelectedElements",value:function(){return this.elements.filter(function(a){return a.isSelected})}},{key:"hasSelectedElements",value:function(){return this.getSelectedElements().length>0}},{key:"toJSON",value:function(){return{code:this.code,elements:this.elements.map(function(a){return a.toJSON()}),levels:this.levels.map(function(a){return a.toJSON()}),explanation:this.explanation,height:this.height,width:this.width,isExam:this.isExam}}},{key:"clone",value:function(){return new a(this.toJSON())}}]),a}();ProgressionUtilities.prototype.templates={},ProgressionUtilities.prototype._name="ProgressionUtilities",ProgressionUtilities.prototype.css='<style>.zyante-bold{font-family:HelveticaNeue-Light,"Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;font-weight:300}.zyante-section-bold{font-family:Helvetica;font-weight:300}div.question-area .zyante-progression-explanation p,div.zyante-progression-explanation-area .zyante-progression-explanation p,div.preview-container .zyante-progression-explanation p{margin-bottom:0}div.question-area .zyante-progression-explanation p:first-child,div.zyante-progression-explanation-area .zyante-progression-explanation p:first-child,div.preview-container .zyante-progression-explanation p:first-child{display:inline}div.question-area .zyante-progression-explanation img,div.zyante-progression-explanation-area .zyante-progression-explanation img,div.preview-container .zyante-progression-explanation img{display:block}div.question-area .zyante-progression-explanation .MathJax_SVG_Display,div.zyante-progression-explanation-area .zyante-progression-explanation .MathJax_SVG_Display,div.preview-container .zyante-progression-explanation .MathJax_SVG_Display{padding-left:0;padding-right:0}div.question-area .element,div.zyante-progression-explanation-area .element,div.preview-container .element{font-family:Roboto,sans-serif}div.question-area .element input,div.zyante-progression-explanation-area .element input,div.preview-container .element input{font-family:Roboto,sans-serif;font-weight:300}div.question-area .element table,div.zyante-progression-explanation-area .element table,div.preview-container .element table{background:#f5f5f5;border:2px solid #bdbdbd;border-collapse:collapse;height:100%;line-height:1;margin:0 auto;white-space:pre;width:100%}div.question-area .element table.fix-width,div.zyante-progression-explanation-area .element table.fix-width,div.preview-container .element table.fix-width{table-layout:fixed}div.question-area .element table th,div.zyante-progression-explanation-area .element table th,div.preview-container .element table th,div.question-area .element table td,div.zyante-progression-explanation-area .element table td,div.preview-container .element table td{border:1px solid #bdbdbd;box-sizing:border-box;width:auto}div.question-area .element table td,div.zyante-progression-explanation-area .element table td,div.preview-container .element table td{padding:8px}div.question-area .element table th,div.zyante-progression-explanation-area .element table th,div.preview-container .element table th{background-color:#e0e0e0;font-weight:300;padding:5px}div.question-area .element.as-spreadsheet>table,div.zyante-progression-explanation-area .element.as-spreadsheet>table,div.preview-container .element.as-spreadsheet>table{table-layout:fixed}div.question-area .element.as-spreadsheet>table td,div.zyante-progression-explanation-area .element.as-spreadsheet>table td,div.preview-container .element.as-spreadsheet>table td{background-color:#fff}div.question-area .element.as-spreadsheet>table th,div.zyante-progression-explanation-area .element.as-spreadsheet>table th,div.preview-container .element.as-spreadsheet>table th,div.question-area .element.as-spreadsheet>table td,div.zyante-progression-explanation-area .element.as-spreadsheet>table td,div.preview-container .element.as-spreadsheet>table td{height:1em;text-align:center;vertical-align:bottom}div.question-area .element.as-spreadsheet>table tr>th:first-child,div.zyante-progression-explanation-area .element.as-spreadsheet>table tr>th:first-child,div.preview-container .element.as-spreadsheet>table tr>th:first-child{width:8%}div.question-area .element.as-spreadsheet>table th,div.zyante-progression-explanation-area .element.as-spreadsheet>table th,div.preview-container .element.as-spreadsheet>table th{color:#666;font-weight:700}div.question-area{position:relative}div.question-area .element{position:absolute}div.question-area .element img{height:100%;width:100%}div.question-area .element .keep-height-ratio{height:auto}div.question-area .element .keep-width-ratio{width:auto}div.question-area .element input{width:100%}div.question-area .element.zb-checkbox{align-items:center;display:flex}div.question-area .element.zb-checkbox label{margin:0;white-space:pre-wrap;width:fit-content}div.question-area .element.as-spreadsheet>button{font-size:16px}div.question-area .element.text-element{line-height:1.4;white-space:pre-wrap}div.question-area div.dropdown,div.question-area div.short-answer{padding:5px}div.question-area div.dropdown select,div.question-area div.short-answer select{font-weight:300}div.question-area div.short-answer input[type=text],div.question-area div.short-answer input[type=number]{box-sizing:content-box;padding:1px}</style>',ProgressionUtilities.prototype.colorEscapeDictionary={},ProgressionUtilities.prototype.createProgression=function(){for(var a=Object.create(Progression.prototype),b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return Progression.apply(a,c),a},ProgressionUtilities.prototype.createLevel=function(){for(var a=Object.create(Level.prototype),b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return Level.apply(a,c),a},ProgressionUtilities.prototype.createQuestion=function(){for(var a=Object.create(Question.prototype),b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return Question.apply(a,c),a},ProgressionUtilities.prototype.createElementVariant=function(){for(var a=Object.create(ElementVariant.prototype),b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return ElementVariant.apply(a,c),a},ProgressionUtilities.prototype.createElementByProperties=function(a){return new(getElementClassByType(a.type))(a)},ProgressionUtilities.prototype.getElementClassNameByType=function(a){return getElementClassNameByType(a)},ProgressionUtilities.prototype.getMostSpecificProperty=function(a,b,c,d){var e=null;return isValueDefined(d,a)?e=d[a]:isValueDefined(c,a)?e=c[a]:isValueDefined(b,a)&&(e=b[a]),e},ProgressionUtilities.prototype.getMostSpecificStyleValueOfElement=function(a,b,c,d){var e=null,f=d&&d.elementVariants.find(function(a){return a.id===b.id}),g=c&&c.elementVariants.find(function(a){return a.id===b.id});return f&&f.style&&f.style[a]?e=f.style[a]:g&&g.style&&g.style[a]?e=g.style[a]:b&&b.style&&b.style[a]&&(e=b.style[a]),e},ProgressionUtilities.prototype.inheritElementController=function(){return new ElementController},ProgressionUtilities.prototype.createElementController=function(){for(var a=Object.create(ElementController.prototype),b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return ElementController.apply(a,c),a},ProgressionUtilities.prototype.createElementDropdownOption=function(){for(var a=Object.create(ElementDropdownOption.prototype),b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return ElementDropdownOption.apply(a,c),a},ProgressionUtilities.prototype.createElementTable=function(){for(var a=Object.create(ElementTable.prototype),b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return ElementTable.apply(a,c),a},ProgressionUtilities.prototype.createElementTableCell=function(){for(var a=Object.create(ElementTableCell.prototype),b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return ElementTableCell.apply(a,c),a},ProgressionUtilities.prototype.createPropertyAndType=function(){for(var a=Object.create(PropertyAndType.prototype),b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return PropertyAndType.apply(a,c),a},ProgressionUtilities.prototype.downloadImage=function(a,b,c,d){downloadImage(c,this.imageURLs(a,b),d)},ProgressionUtilities.prototype.imageURLs=function(a,b){return makeImageURLs(a,b)};var fillColorModalNameToXMLName={blue:"zyAnimatorBlue",green:"zyAnimatorGreen",orange:"zyAnimatorOrange"};ProgressionUtilities.prototype.fillColorModalNameToXMLName=fillColorModalNameToXMLName,ProgressionUtilities.prototype.convertFillColorModalNameToXMLName=function(a){var b=null;return this.fillColorModalNameToXMLName[a]?b=this.fillColorModalNameToXMLName[a]:"default"!==a&&(b=a),b};var imageRegEx=/\[image\s*(\d*)\s*(\d*)]\(((\w|\-)+)\)(\(([^\)]+)\))?/;ProgressionUtilities.prototype.getExplanationImageRegex=function(){return imageRegEx},ProgressionUtilities.prototype.processExplanation=function(a,b){for(var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=/\[spreadsheet\s*(\d*)\s*(\d*)\s*(\d*)\]\s*\[([^\]]*)\]\s*(\[([^\]]*)\])?/,e=/\[table\s*(hrow)?\s*(hcol)?\s*(\d*)\s*(\d*)\s*(\d*)\]\s*\[([^\]]*)\]/,f=/\\\[table\s*(hrow)?\s*(hcol)?\s*(\d*)\s*(\d*)\s*(\d*)\\\]\s*\\\[(((?!\\\])[^\x05])*)\\\]/,g=b,h=[],i=[new ExplanationElementType(imageRegEx,makeImageElementForExplanation,[a,c]),new ExplanationElementType(d,makeSpreadsheetElementForExplanation),new ExplanationElementType(e,makeTableElementForExplanation),new ExplanationElementType(f,makeTableElementForExplanation)];isExplanationElementRemaining(i,g);){var j=getExplanationElementMatches(i,g),k=j.reduce(function(a,b){return a.index<b.index?a:b}),l=k.match,m=k.elementType.makeElement(l),n=g.slice(0,l.index);h.push(createParagraphTag(n)),h.push(m);var o=l.index+l[0].length;g=g.slice(o)}return g.length>0&&h.push(createParagraphTag(g)),h.map(function(a){return a[0].outerHTML}).join("")},ProgressionUtilities.prototype.postProcessExplanation=function(a){var b=a.id,c=$("#"+b+" .zyante-progression-explanation"),d=require("ProgressionUtilities").create();c.html(c.text()),c.find(".explanation-image").each(function(b,c){var e=$(c),f=e.attr("image-id");d.downloadImage(a.parentResource,f,$(c),"[Image did not load. Please try refreshing. If the issue persists, please contact support@zybooks.com.]")}),a.parentResource.latexChanged()},ProgressionUtilities.prototype.replaceBackticks=function(a){return replaceBackticks(a)},ProgressionUtilities.prototype.escapeStyleValues=function(a){return escapeStyleValues.call(this,a)},ProgressionUtilities.prototype.replaceStringVariables=function(a,b){return replaceStringVariables(a,b)},ProgressionUtilities.prototype.makePythonModule=function(a,b,c){return require("utilities").makePythonModule(commonFunctions+a+b+c)},ProgressionUtilities.prototype.makeTableElementToRender=function(a){return a.listName||a.tableData.data||a.tableData.forEach(function(a){return a.forEach(function(a){return a.changeToPrintableStyles()})}),a},ProgressionUtilities.prototype.reviseLineNumberInErrorMessage=function(a,b,c){var d=2,e=numberOfLinesOfCode(commonFunctions)+d,f=e+numberOfLinesOfCode(b)+1,g=f+numberOfLinesOfCode(c);return a.replace(/\son\sline\s(\d+)/g,function(a,b){var c=parseInt(b,10),d=c-e,h="global";return c>=g?(d=c-g+1,h="question"):c>=f&&(d=c-f+1,h="level"),d>0?" on line "+d+" of "+h+"'s code":""})},ProgressionUtilities.prototype.addSpreadsheetHeaders=function(a){addSpreadsheetHeaders(a)},ProgressionUtilities.prototype.removeSpreadsheetHeaders=function(a){removeSpreadsheetHeaders(a,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")},ProgressionUtilities.prototype.testProperties=function(a,b,c){testProperties.call(this,a,b,c)},ProgressionUtilities.prototype.latexInText=function(a){return/\\\(.*\\\)|\$\$.*\$\$/.test(a)};var ProgressionUtilitiesExport={create:function(){return this._progressionUtilities||(this._progressionUtilities=new ProgressionUtilities),this._progressionUtilities},dependencies:{tools:["utilities"]},runTests:function(){}};module.exports=ProgressionUtilitiesExport;var Question=function(){function a(b){_classCallCheck(this,a);var c=b.elementVariants||[];this.code=b.code||"",this.elementVariants=c.map(function(a){return new ElementVariant(a)}),this.explanation=b.explanation||"",this.height=b.height,this.isSelected=b.isSelected,this.name=b.name,this.usedElements=b.usedElements,this.width=b.width}return _createClass(a,[{key:"clone",value:function(){return new a(this.toJSON())}},{key:"toJSON",value:function(){return{code:this.code,elementVariants:this.elementVariants.map(function(a){return a.toJSON()}),explanation:this.explanation,height:this.height,isSelected:this.isSelected,name:this.name,usedElements:this.usedElements.slice(),width:this.width}}}]),a}(),ExplanationElementType=function(){function a(b,c){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];_classCallCheck(this,a),this.regex=b,this.elementBuilderFunction=c,this.parameters=d}return _createClass(a,[{key:"isInstanceRemaining",value:function(a){return this.regex.test(a)}},{key:"getMatch",value:function(a){var b=this.regex.exec(a);return{elementType:this,match:b,index:b?b.index:1/0}}},{key:"makeElement",value:function(a){return this.elementBuilderFunction.apply(this,[a].concat(_toConsumableArray(this.parameters)))}}]),a}(),TwoDimensionalList=function a(b){_classCallCheck(this,a),this.numRows=b.v.length,this.numCols=b.v[0].v.length,this.variables=b.v.map(function(a){return a.v.map(function(a){return a.v})})},commonFunctions="from common_functions import make_words_from_list, pickFrom, pickFromRange, sig_fig_round, sig, sigFigRound, scientific_notation, scientificNotation, parens_if_negative, meanOfList, medianOfList, stddevOfList\nimport math\nimport random\nimport string\n",colorEscapeDictionary={};exports.default=module.exports});